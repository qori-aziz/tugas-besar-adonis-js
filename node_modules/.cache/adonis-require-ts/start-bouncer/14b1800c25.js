"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.policies = exports.actions = void 0;
const Bouncer_1 = __importDefault(global[Symbol.for('ioc.use')]("Adonis/Addons/Bouncer"));
exports.actions = Bouncer_1.default.define('ownerAuthorization', (user) => {
    if (user.role === 'owner') {
        return true;
    }
    return Bouncer_1.default.deny('Unauthorized : Owner priviledge only', 404);
})
    .define('ownerVenues', (user, venue) => {
    if (user.role === 'owner' && user.id === venue.users_id) {
        return true;
    }
    return Bouncer_1.default.deny('Unauthorized : While you are an owner, this venue is not yours', 403);
})
    .define('bookedUser', (user, booking) => {
    if (user.id === booking.users_id) {
        return true;
    }
    return Bouncer_1.default.deny('Unauthorized : You cannot edit this booking since it is not yours', 403);
}).actions;
exports.policies = Bouncer_1.default.registerPolicies({}).policies;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm91bmNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImJvdW5jZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBT0EsMEZBQWdEO0FBMkJqQyxlQUFPLEdBQUssaUJBQU8sQ0FBQyxNQUFNLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxJQUFVLEVBQUUsRUFBRTtJQUM3RSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssT0FBTyxFQUFFO1FBQ3pCLE9BQU8sSUFBSSxDQUFBO0tBQ1o7SUFDRCxPQUFPLGlCQUFPLENBQUMsSUFBSSxDQUFDLHNDQUFzQyxFQUFFLEdBQUcsQ0FBQyxDQUFBO0FBQ2xFLENBQUMsQ0FBQztLQUNDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsQ0FBQyxJQUFVLEVBQUUsS0FBWSxFQUFFLEVBQUU7SUFDbEQsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLE9BQU8sSUFBSSxJQUFJLENBQUMsRUFBRSxLQUFLLEtBQUssQ0FBQyxRQUFRLEVBQUU7UUFDdkQsT0FBTyxJQUFJLENBQUE7S0FDWjtJQUNELE9BQU8saUJBQU8sQ0FBQyxJQUFJLENBQUMsZ0VBQWdFLEVBQUUsR0FBRyxDQUFDLENBQUE7QUFDNUYsQ0FBQyxDQUFDO0tBQ0QsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFDLElBQVUsRUFBRSxPQUFnQixFQUFFLEVBQUU7SUFDckQsSUFBSSxJQUFJLENBQUMsRUFBRSxLQUFLLE9BQU8sQ0FBQyxRQUFRLEVBQUU7UUFDaEMsT0FBTyxJQUFJLENBQUE7S0FDWjtJQUNELE9BQU8saUJBQU8sQ0FBQyxJQUFJLENBQUMsbUVBQW1FLEVBQUUsR0FBRyxDQUFDLENBQUE7QUFDL0YsQ0FBQyxDQUFDLFNBQUE7QUF3QlcsZ0JBQVEsR0FBSyxpQkFBTyxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxVQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb250cmFjdCBzb3VyY2U6IGh0dHBzOi8vZ2l0LmlvL0p0ZTNUXG4gKlxuICogRmVlbCBmcmVlIHRvIGxldCB1cyBrbm93IHZpYSBQUiwgaWYgeW91IGZpbmQgc29tZXRoaW5nIGJyb2tlbiBpbiB0aGlzIGNvbmZpZ1xuICogZmlsZS5cbiAqL1xuXG5pbXBvcnQgQm91bmNlciBmcm9tICdAaW9jOkFkb25pcy9BZGRvbnMvQm91bmNlcidcbmltcG9ydCBCb29raW5nIGZyb20gJ0FwcC9Nb2RlbHMvQm9va2luZydcbmltcG9ydCBVc2VyIGZyb20gJ0FwcC9Nb2RlbHMvVXNlcidcbmltcG9ydCBWZW51ZSBmcm9tICdBcHAvTW9kZWxzL1ZlbnVlJ1xuXG4vKlxufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58IEJvdW5jZXIgQWN0aW9uc1xufC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG58XG58IEFjdGlvbnMgYWxsb3dzIHlvdSB0byBzZXBhcmF0ZSB5b3VyIGFwcGxpY2F0aW9uIGJ1c2luZXNzIGxvZ2ljIGZyb20gdGhlXG58IGF1dGhvcml6YXRpb24gbG9naWMuIEZlZWwgZnJlZSB0byBtYWtlIHVzZSBvZiBwb2xpY2llcyB3aGVuIHlvdSBmaW5kXG58IHlvdXJzZWxmIGNyZWF0aW5nIHRvbyBtYW55IGFjdGlvbnNcbnxcbnwgWW91IGNhbiBkZWZpbmUgYW4gYWN0aW9uIHVzaW5nIHRoZSBgLmRlZmluZWAgbWV0aG9kIG9uIHRoZSBCb3VuY2VyIG9iamVjdFxufCBhcyBzaG93biBpbiB0aGUgZm9sbG93aW5nIGV4YW1wbGVcbnxcbnwgYGBgXG58IFx0Qm91bmNlci5kZWZpbmUoJ2RlbGV0ZVBvc3QnLCAodXNlcjogVXNlciwgcG9zdDogUG9zdCkgPT4ge1xufFx0XHRcdHJldHVybiBwb3N0LnVzZXJfaWQgPT09IHVzZXIuaWRcbnwgXHR9KVxufCBgYGBcbnxcbnwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG58IE5PVEU6IEFsd2F5cyBleHBvcnQgdGhlIFwiYWN0aW9uc1wiIGNvbnN0IGZyb20gdGhpcyBmaWxlXG58KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuKi9cbmV4cG9ydCBjb25zdCB7IGFjdGlvbnMgfSA9IEJvdW5jZXIuZGVmaW5lKCdvd25lckF1dGhvcml6YXRpb24nLCAodXNlcjogVXNlcikgPT4ge1xuICBpZiAodXNlci5yb2xlID09PSAnb3duZXInKSB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICByZXR1cm4gQm91bmNlci5kZW55KCdVbmF1dGhvcml6ZWQgOiBPd25lciBwcml2aWxlZGdlIG9ubHknLCA0MDQpXG59KVxuICAuZGVmaW5lKCdvd25lclZlbnVlcycsICh1c2VyOiBVc2VyLCB2ZW51ZTogVmVudWUpID0+IHtcbiAgICBpZiAodXNlci5yb2xlID09PSAnb3duZXInICYmIHVzZXIuaWQgPT09IHZlbnVlLnVzZXJzX2lkKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICByZXR1cm4gQm91bmNlci5kZW55KCdVbmF1dGhvcml6ZWQgOiBXaGlsZSB5b3UgYXJlIGFuIG93bmVyLCB0aGlzIHZlbnVlIGlzIG5vdCB5b3VycycsIDQwMylcbiAgfSlcbiAgLmRlZmluZSgnYm9va2VkVXNlcicsICh1c2VyOiBVc2VyLCBib29raW5nOiBCb29raW5nKSA9PiB7XG4gICAgaWYgKHVzZXIuaWQgPT09IGJvb2tpbmcudXNlcnNfaWQpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHJldHVybiBCb3VuY2VyLmRlbnkoJ1VuYXV0aG9yaXplZCA6IFlvdSBjYW5ub3QgZWRpdCB0aGlzIGJvb2tpbmcgc2luY2UgaXQgaXMgbm90IHlvdXJzJywgNDAzKVxuICB9KVxuLypcbnwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxufCBCb3VuY2VyIFBvbGljaWVzXG58LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnxcbnwgUG9saWNpZXMgYXJlIHNlbGYgY29udGFpbmVkIGFjdGlvbnMgZm9yIGEgZ2l2ZW4gcmVzb3VyY2UuIEZvciBleGFtcGxlOiBZb3VcbnwgY2FuIGNyZWF0ZSBhIHBvbGljeSBmb3IgYSBcIlVzZXJcIiByZXNvdXJjZSwgb25lIHBvbGljeSBmb3IgYSBcIlBvc3RcIiByZXNvdXJjZVxufCBhbmQgc28gb24uXG58XG58IFRoZSBcInJlZ2lzdGVyUG9saWNpZXNcIiBhY2NlcHRzIGEgdW5pcXVlIHBvbGljeSBuYW1lIGFuZCBhIGZ1bmN0aW9uIHRvIGxhenlcbnwgaW1wb3J0IHRoZSBwb2xpY3lcbnxcbnwgYGBgXG58IFx0Qm91bmNlci5yZWdpc3RlclBvbGljaWVzKHtcbnxcdFx0XHRVc2VyUG9saWN5OiAoKSA9PiBpbXBvcnQoJ0FwcC9Qb2xpY2llcy9Vc2VyJyksXG58IFx0XHRQb3N0UG9saWN5OiAoKSA9PiBpbXBvcnQoJ0FwcC9Qb2xpY2llcy9Qb3N0JylcbnwgXHR9KVxufCBgYGBcbnxcbnwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG58IE5PVEU6IEFsd2F5cyBleHBvcnQgdGhlIFwicG9saWNpZXNcIiBjb25zdCBmcm9tIHRoaXMgZmlsZVxufCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiovXG5leHBvcnQgY29uc3QgeyBwb2xpY2llcyB9ID0gQm91bmNlci5yZWdpc3RlclBvbGljaWVzKHt9KVxuIl19